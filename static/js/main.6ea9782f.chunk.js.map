{"version":3,"sources":["App.tsx","reportWebVitals.ts","index.tsx"],"names":["heroMarketUrl","id","ScanTable","props","scanHeroParams","onRemoveClick","heroPrice","interval","heroName","useState","data","setData","intervalRef","useRef","fetchHeroes","useCallback","a","fetch","headers","accept","pragma","referrer","referrerPolicy","body","method","mode","credentials","response","json","jsonResponse","items","lowestPriceHero","forEach","item","price","sale","name","image","find","Notification","icon","onclick","window","open","uniqBy","columns","useMemo","key","dataIndex","title","width","render","src","hero","target","href","rel","useEffect","current","clearInterval","setInterval","rowKey","danger","onClick","type","shape","DeleteOutlined","dataSource","App","heroParams","setHeroParams","permission","requestPermission","style","paddingTop","labelCol","span","wrapperCol","initialValues","onFinish","values","heroParam","notification","error","message","autoComplete","Item","label","rules","required","min","offset","htmlType","map","param","clonedParams","cloneDeep","remove","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.6ea9782f.chunk.js","sourcesContent":["import React, {\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from \"react\";\nimport \"antd/dist/antd.css\";\nimport {\n  Image,\n  Button,\n  Form,\n  Input,\n  InputNumber,\n  notification,\n  Table,\n} from \"antd\";\nimport { ColumnsType } from \"antd/es/table\";\nimport { uniqBy, find, remove, cloneDeep } from \"lodash\";\nimport { DeleteOutlined } from \"@ant-design/icons\";\n\ninterface ScanHeroParams {\n  heroName: string;\n  heroPrice: number;\n  interval: number;\n}\n\ninterface Hero {\n  id: string;\n  name: string;\n  image: string;\n  sale: {\n    price: number;\n  };\n}\n\nconst heroMarketUrl = (id: string) =>\n  `https://market.heroesempires.com/market/${id}`;\n\ninterface Props {\n  scanHeroParams: ScanHeroParams;\n  onRemoveClick: () => void;\n}\n\nconst ScanTable: React.FC<Props> = (props) => {\n  const { scanHeroParams, onRemoveClick } = props;\n  const { heroPrice, interval, heroName } = scanHeroParams;\n  const [data, setData] = useState<Hero[]>([]);\n  const intervalRef = useRef<number>();\n\n  const fetchHeroes = useCallback(async () => {\n    const response = await fetch(\n      `https://marketplace-api.heroesempires.com/sale-items?class&desc=false&listedOnMarket=true&minPrice&orderBy=price&page=1&race&search=${heroName}&size=21&tier&maxPrice=${heroPrice}`,\n      {\n        headers: {\n          accept: \"application/json, text/plain, */*\",\n          \"accept-language\": \"en-US,en;q=0.9\",\n          \"cache-control\": \"no-cache\",\n          pragma: \"no-cache\",\n          \"sec-fetch-dest\": \"empty\",\n          \"sec-fetch-mode\": \"cors\",\n          \"sec-fetch-site\": \"same-site\",\n          \"sec-gpc\": \"1\",\n        },\n        referrer: \"https://market.heroesempires.com/\",\n        referrerPolicy: \"strict-origin-when-cross-origin\",\n        body: null,\n        method: \"GET\",\n        mode: \"cors\",\n        credentials: \"omit\",\n      }\n    );\n    const jsonResponse = await response.json();\n    const items: Hero[] = jsonResponse.data.items;\n    let lowestPriceHero: Hero = items[0];\n\n    items.forEach((item) => {\n      const {\n        sale: { price },\n      } = item;\n      if (!lowestPriceHero || price < lowestPriceHero.sale.price) {\n        lowestPriceHero = item;\n      }\n    });\n\n    if (!lowestPriceHero || lowestPriceHero.sale.price > heroPrice) {\n      return;\n    }\n\n    const {\n      id,\n      name,\n      image,\n      sale: { price },\n    } = lowestPriceHero;\n\n    const existing = find(data, [\"id\", id]);\n    if (existing) {\n      return;\n    }\n\n    const notification = new Notification(\"ScanHero\", {\n      image,\n      icon: image,\n      body: `${name}: ${price}`,\n    });\n    notification.onclick = function () {\n      window.open(heroMarketUrl(id));\n    };\n    setData(uniqBy([...data, lowestPriceHero], \"id\"));\n  }, [data, setData, heroName, heroPrice]);\n\n  const columns = useMemo<ColumnsType<Hero>>(\n    () => [\n      {\n        key: \"image\",\n        dataIndex: \"image\",\n        title: \"Image\",\n        width: 100,\n        render(image: string) {\n          return <Image width={100} src={image} />;\n        },\n      },\n      {\n        key: \"id\",\n        dataIndex: \"id\",\n        title: \"ID\",\n        render(id: string, hero) {\n          const { name } = hero;\n          return (\n            <a target=\"_blank\" href={heroMarketUrl(id)} rel=\"noreferrer\">\n              {name}\n            </a>\n          );\n        },\n      },\n      {\n        key: \"price\",\n        dataIndex: [\"sale\", \"price\"],\n        title: \"Price\",\n      },\n    ],\n    []\n  );\n\n  useEffect(() => {\n    if (intervalRef.current) {\n      clearInterval(intervalRef.current);\n    }\n    intervalRef.current = window.setInterval(fetchHeroes, interval);\n    return () => {\n      clearInterval(intervalRef.current);\n    };\n  }, [fetchHeroes, interval]);\n\n  return (\n    <Table\n      rowKey=\"id\"\n      title={() => (\n        <strong>\n          {heroName}: {heroPrice}{\" \"}\n          <Button\n            danger\n            onClick={onRemoveClick}\n            type=\"primary\"\n            shape=\"circle\"\n            icon={<DeleteOutlined />}\n          />\n        </strong>\n      )}\n      columns={columns}\n      dataSource={data}\n    />\n  );\n};\n\nfunction App() {\n  const [heroParams, setHeroParams] = useState<ScanHeroParams[]>([]);\n\n  useEffect(() => {\n    if (Notification.permission !== \"granted\") {\n      Notification.requestPermission();\n    }\n  }, []);\n\n  const onFinish = (values: ScanHeroParams) => {\n    const existing = !!heroParams.find(\n      (heroParam) =>\n        heroParam.heroPrice === values.heroPrice &&\n        heroParam.heroName === values.heroName\n    );\n    if (existing) {\n      notification.error({\n        message: \"Existing\",\n      });\n      return;\n    }\n    setHeroParams([...heroParams, values]);\n  };\n\n  return (\n    <Form<ScanHeroParams>\n      style={{\n        paddingTop: 20,\n      }}\n      name=\"scanForm\"\n      labelCol={{ span: 8 }}\n      wrapperCol={{ span: 8 }}\n      initialValues={{\n        heroName: \"Tusk\",\n        heroPrice: 240,\n        interval: 5000,\n      }}\n      onFinish={onFinish}\n      autoComplete=\"off\"\n    >\n      <Form.Item\n        label=\"Hero Name\"\n        name=\"heroName\"\n        rules={[{ required: true, message: \"Please input hero name!\" }]}\n      >\n        <Input />\n      </Form.Item>\n\n      <Form.Item\n        label=\"Hero Price\"\n        name=\"heroPrice\"\n        rules={[{ required: true, message: \"Please input hero price!\" }]}\n      >\n        <InputNumber min={1} />\n      </Form.Item>\n\n      <Form.Item\n        label=\"Set Interval\"\n        name=\"interval\"\n        rules={[{ required: true, message: \"Please input interval!\" }]}\n      >\n        <InputNumber min={2000} />\n      </Form.Item>\n\n      <Form.Item wrapperCol={{ offset: 8, span: 16 }}>\n        <Button type=\"primary\" htmlType=\"submit\">\n          Submit\n        </Button>\n      </Form.Item>\n      {heroParams.map((param) => (\n        <ScanTable\n          key={`${param.heroName}_${param.heroPrice}`}\n          scanHeroParams={param}\n          onRemoveClick={() => {\n            const clonedParams = cloneDeep(heroParams);\n            remove(\n              clonedParams,\n              (item) =>\n                item.heroName === param.heroName &&\n                item.heroPrice === param.heroPrice\n            );\n            setHeroParams(clonedParams);\n          }}\n        />\n      ))}\n    </Form>\n  );\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}